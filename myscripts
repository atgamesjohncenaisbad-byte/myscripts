--[[
    SILENT SURGEON: Upvalue Modifier
    Bypass: No Metatable Hooks, No Kick Hooks (Adonis Undetected)
    Target: Internal variable 'var33_upvw' (Damage Multiplier)
]]

local CONFIG = {
    -- START LOW. If you set this to 100 and get kicked upon hitting an enemy,
    -- it means the SERVER has a sanity check. Try 5 or 10 first.
    MULTIPLIER = 10, 
    DEBUG = true
}

local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")
local LocalPlayer = Players.LocalPlayer

-- // UI SETUP \\ --
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "SilentSurgeon"
if gethui then
    ScreenGui.Parent = gethui()
else
    ScreenGui.Parent = CoreGui
end

local Label = Instance.new("TextLabel")
Label.Size = UDim2.new(0, 200, 0, 50)
Label.Position = UDim2.new(0.5, -100, 0.15, 0)
Label.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Label.TextColor3 = Color3.fromRGB(255, 255, 255)
Label.Text = "STATUS: WAITING..."
Label.BorderSizePixel = 0
Label.Parent = ScreenGui

-- // THE SURGERY \\ --
local function InjectDmg(tool)
    if not tool then return end
    
    -- Wait for the tool's script to initialize
    task.wait(1) 
    
    local handle = tool:FindFirstChild("Handle")
    if not handle then 
        Label.Text = "NO HANDLE FOUND"
        return 
    end

    -- 1. Get the Touch event (This connects to 'onHandleTouched')
    -- Note: Some executors use 'getconnections', others use 'get_signal_cons'
    local connections = getconnections(handle.Touched)
    
    if #connections == 0 then
        Label.Text = "NO CONNECTIONS FOUND"
        return
    end

    Label.Text = "SCANNING MEMORY..."
    Label.TextColor3 = Color3.fromRGB(255, 255, 0)

    for _, conn in pairs(connections) do
        local func = conn.Function
        if func then
            -- 2. We are in 'onHandleTouched'. Look for 'dealDamage' upvalue.
            local upvalues = debug.getupvalues(func)
            
            for i, v in pairs(upvalues) do
                if type(v) == "function" then
                    -- 3. We are likely in 'dealDamage'. Look for the multiplier number.
                    -- In the dump, the multiplier was initialized as 1 or 2.
                    local inner_ups = debug.getupvalues(v)
                    
                    for j, val in pairs(inner_ups) do
                        if type(val) == "number" and (val == 1 or val == 2) then
                            
                            -- 4. THE SWAP
                            debug.setupvalue(v, j, CONFIG.MULTIPLIER)
                            
                            Label.Text = "INJECTED: " .. CONFIG.MULTIPLIER .. "x"
                            Label.TextColor3 = Color3.fromRGB(0, 255, 0)
                            return -- Success, exit function
                        end
                    end
                end
            end
        end
    end
    
    Label.Text = "INJECTION FAILED"
    Label.TextColor3 = Color3.fromRGB(255, 0, 0)
end

-- // AUTO-INJECTOR \\ --
LocalPlayer.CharacterAdded:Connect(function(char)
    char.ChildAdded:Connect(function(child)
        if child:IsA("Tool") then
            InjectDmg(child)
        end
    end)
end)

-- Initial Check
if LocalPlayer.Character then
    local tool = LocalPlayer.Character:FindFirstChildWhichIsA("Tool")
    if tool then
        InjectDmg(tool)
    else
        Label.Text = "EQUIP SWORD"
    end
end
