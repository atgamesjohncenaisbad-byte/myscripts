-- Penetration Testing Script: Vulnerability #2 (DummyEvent Logic Injection)
-- Purpose: Verify if the server validates target entity type and clamps damage values.

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local DummyEvent = ReplicatedStorage:WaitForChild("DummyEvent")

-- Testing for lack of server-side damage clamping and target validation
local TEST_DAMAGE = 9e18 

local function executeTest()
    -- Target folder identified from Workspace.Entity_25y.ShortNotation
    local mobsFolder = workspace:FindFirstChild("Mobs ")
    
    if mobsFolder then
        for _, zone in ipairs(mobsFolder:GetChildren()) do
            for _, mob in ipairs(zone:GetChildren()) do
                local humanoid = mob:FindFirstChildOfClass("Humanoid")
                if humanoid and humanoid.Health > 0 then
                    -- Direct injection: Bypassing the 'dummyScript' requirement
                    -- and sending a value that should exceed server-side limits.
                    DummyEvent:FireServer(TEST_DAMAGE, humanoid)
                end
            end
        end
        print("Vulnerability #2 Test: DummyEvent fired for all entities in 'Mobs ' folder.")
    else
        -- Fallback: Scan workspace for any Humanoid not belonging to the LocalPlayer
        for _, desc in ipairs(workspace:GetDescendants()) do
            if desc:IsA("Humanoid") and not desc:IsDescendantOf(game.Players.LocalPlayer.Character) then
                DummyEvent:FireServer(TEST_DAMAGE, desc)
            end
        end
        print("Vulnerability #2 Test: DummyEvent fired via global workspace scan.")
    end
end

executeTest()
